ggplot() + theme_bw()  + xlim(40, 75) + ylim(5,20) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(y=X2,x=X1,xmax=113,ymin = X2, ymax = 30), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=3) +
annotate(geom="text", x=60, y=20, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=40, y=15, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=60, y=9, label="Optimal Set", color="black",size = 5) +
theme(legend.position="none")
ggplot() + theme_bw()  + xlim(40, 75) + ylim(5,20) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(y=X2,x=X1,ymin = X2, ymax = 30), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=3) +
annotate(geom="text", x=60, y=20, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=40, y=15, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=60, y=9, label="Optimal Set", color="black",size = 5) +
theme(legend.position="none")
ggplot() + theme_bw()  + xlim(40, 75) + ylim(5,20) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(y=X2,ymin = X2, ymax = 30), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=3) +
annotate(geom="text", x=60, y=20, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=40, y=15, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=60, y=9, label="Optimal Set", color="black",size = 5) +
theme(legend.position="none")
ggplot() + theme_bw()  + xlim(40, 75) + ylim(5,20) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 30), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=3) +
annotate(geom="text", x=60, y=20, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=40, y=15, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=60, y=9, label="Optimal Set", color="black",size = 5) +
theme(legend.position="none")
eqpower
ggplot() + theme_bw()  + xlim(40, 75) + ylim(5,20) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 20), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=3) +
annotate(geom="text", x=60, y=20, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=40, y=15, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=60, y=9, label="Optimal Set", color="black",size = 5) +
theme(legend.position="none")
ggplot() + theme_bw()  +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 30), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=3) +
annotate(geom="text", x=60, y=20, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=40, y=15, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=60, y=9, label="Optimal Set", color="black",size = 5) +
theme(legend.position="none") + xlim(40, 75) + ylim(5,20) +
g1 = grid.arrange(p7,p7, ncol=2)
ggplot() + theme_bw()  +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 20), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=3) +
annotate(geom="text", x=60, y=20, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=40, y=15, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=60, y=9, label="Optimal Set", color="black",size = 5) +
theme(legend.position="none") + xlim(40, 75) + ylim(5,20) +
g1 = grid.arrange(p7,p7, ncol=2)
ggplot() + theme_bw()  +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 20), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=3) +
annotate(geom="text", x=60, y=20, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=40, y=15, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=60, y=9, label="Optimal Set", color="black",size = 5) +
theme(legend.position="none") + xlim(40, 75) + ylim(5,20)
ggplot() + theme_bw()  +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 30), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=3) +
annotate(geom="text", x=60, y=20, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=40, y=15, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=60, y=9, label="Optimal Set", color="black",size = 5) +
theme(legend.position="none") + xlim(40, 75) + ylim(5,20)
ggplot() + theme_bw()  + xlim(40, 75) + ylim(5,20) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 20), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=3) +
annotate(geom="text", x=60, y=20, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=40, y=15, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=60, y=9, label="Optimal Set", color="black",size = 5) +
theme(legend.position="none")
ggplot() + theme_bw()  + xlim(40, 75) + ylim(5,20) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 20), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=3) +
annotate(geom="text", x=60, y=15, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=48, y=12, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=60, y=9, label="Optimal Set", color="black",size = 5) +
theme(legend.position="none")
g1 = grid.arrange(p7,p7, ncol=2)
p7 = ggplot() + theme_bw()  + xlim(40, 75) + ylim(5,20) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 20), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=3) +
annotate(geom="text", x=60, y=15, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=48, y=12, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=60, y=9, label="Optimal Set", color="black",size = 5) +
theme(legend.position="none")
g1 = grid.arrange(p7,p7, ncol=2)
pdf(paste0(folder,"multi_true_2D.pdf"),height=6,width=11);grid.draw(g1);dev.off()
p7 = ggplot() + theme_bw()  + xlim(40, 75) + ylim(5,20) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 20), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=3) +
annotate(geom="text", x=65, y=14, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=48, y=12, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=60, y=9, label="Optimal Set", color="black",size = 5, hjust = "left") +
theme(legend.position="none")
g1 = grid.arrange(p7,p7, ncol=2)
p7 = ggplot() + theme_bw()  + xlim(40, 75) + ylim(5,20) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 20), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=3) +
annotate(geom="text", x=65, y=14, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=48, y=12, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=61, y=10, label="Optimal Set", color="black",size = 5, hjust = "left") +
theme(legend.position="none")
g1 = grid.arrange(p7,p7, ncol=2)
p7 = ggplot() + theme_bw()  + xlim(40, 75) + ylim(5,20) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 20), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=4) +
annotate(geom="text", x=65, y=14, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=48, y=12, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=61, y=10, label="Optimal Set", color="black",size = 5, hjust = "left") +
theme(legend.position="none")
g1 = grid.arrange(p7,p7, ncol=2)
p7 = ggplot() + theme_bw()  + xlim(40, 75) + ylim(5,20) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 20), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=10) +
annotate(geom="text", x=65, y=14, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=48, y=12, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=61, y=10, label="Optimal Set", color="black",size = 5, hjust = "left") +
theme(legend.position="none")
g1 = grid.arrange(p7,p7, ncol=2)
p7 = ggplot() + theme_bw()  + xlim(40, 75) + ylim(5,20) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 20), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=3) +
annotate(geom="text", x=65, y=14, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=48, y=12, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=61, y=10, label="Optimal Set", color="black",size = 5, hjust = "left") +
theme(legend.position="none")
g1 = grid.arrange(p7,p7, ncol=2)
p7 = ggplot() + theme_bw()  + xlim(40, 75) + ylim(5,20) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 20), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=5) +
annotate(geom="text", x=65, y=14, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=48, y=12, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=61, y=10, label="Optimal Set", color="black",size = 5, hjust = "left") +
theme(legend.position="none")
g1 = grid.arrange(p7,p7, ncol=2)
pdf(paste0(folder,"multi_true_2D.pdf"),height=6,width=11);grid.draw(g1);dev.off()
p7 = ggplot() + theme_bw()  + xlim(40, 75) + ylim(5,20) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 20), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=5) +
annotate(geom="text", x=65, y=14, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=48, y=12, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=62, y=10, label="Optimal Set", color="black",size = 5, hjust = "left") +
theme(legend.position="none")
g1 = grid.arrange(p7,p7, ncol=2)
p7 = ggplot() + theme_bw()  + xlim(40, 75) + ylim(5,17) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 17), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=5) +
annotate(geom="text", x=65, y=14, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=48, y=12, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=62, y=10, label="Optimal Set", color="black",size = 5, hjust = "left") +
theme(legend.position="none")
g1 = grid.arrange(p7,p7, ncol=2)
p7 = ggplot() + theme_bw()  + xlim(40, 75) + ylim(5,16) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 16), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=5) +
annotate(geom="text", x=65, y=14, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=48, y=12, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=62, y=10, label="Optimal Set", color="black",size = 5, hjust = "left") +
theme(legend.position="none")
g1 = grid.arrange(p7,p7, ncol=2)
pdf(paste0(folder,"multi_true_2D.pdf"),height=6,width=11);grid.draw(g1);dev.off()
p7 = ggplot() + theme_bw()  + xlim(50, 75) + ylim(5,16) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 16), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=5) +
annotate(geom="text", x=65, y=14, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=48, y=12, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=62, y=10, label="Optimal Set", color="black",size = 5, hjust = "left") +
theme(legend.position="none")
g1 = grid.arrange(p7,p7, ncol=2)
pdf(paste0(folder,"multi_true_2D.pdf"),height=6,width=11);grid.draw(g1);dev.off()
p7 = ggplot() + theme_bw()  + xlim(40, 80) + ylim(5,16) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 16), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=5) +
annotate(geom="text", x=65, y=14, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=48, y=12, label="Optimal Cost", color="#B2182B",size = 5) +
annotate(geom="text", x=62, y=10, label="Optimal Set", color="black",size = 5, hjust = "left") +
theme(legend.position="none")
g1 = grid.arrange(p7,p7, ncol=2)
pdf(paste0(folder,"multi_true_2D.pdf"),height=6,width=11);grid.draw(g1);dev.off()
p7 = ggplot() + theme_bw()  + xlim(40, 80) + ylim(5,16) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 16), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=5) +
annotate(geom="text", x=65, y=14, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=65, y=7, label="Optimal Cost", color="#B2182B",size = 5,hjust = "right") +
annotate(geom="text", x=62, y=10, label="Optimal Set", color="black",size = 5, hjust = "left") +
theme(legend.position="none")
g1 = grid.arrange(p7,p7, ncol=2)
pdf(paste0(folder,"multi_true_2D.pdf"),height=6,width=11);grid.draw(g1);dev.off()
p7 = ggplot() + theme_bw()  + xlim(40, 80) + ylim(5,16) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 16), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=5) +
annotate(geom="text", x=58, y=14, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=67, y=7, label="Optimal Cost", color="#B2182B",size = 5,hjust = "right") +
annotate(geom="text", x=58, y=10, label="Optimal Set", color="black",size = 5, hjust = "right") +
theme(legend.position="none")
g1 = grid.arrange(p7,p7, ncol=2)
pdf(paste0(folder,"multi_true_2D.pdf"),height=6,width=11);grid.draw(g1);dev.off()
p7 = ggplot() + theme_bw()  + xlim(40, 80) + ylim(5,16) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 16), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=5) +
annotate(geom="text", x=61, y=14, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=67, y=7, label="Optimal Cost", color="#B2182B",size = 5,hjust = "right") +
annotate(geom="text", x=58, y=10, label="Optimal Set", color="black",size = 5, hjust = "right") +
theme(legend.position="none")
g1 = grid.arrange(p7,p7, ncol=2)
pdf(paste0(folder,"multi_true_2D.pdf"),height=6,width=11);grid.draw(g1);dev.off()
eqpower[eqpower$X1==58,]
eqcost[eqcost$X1==58,]
usetask = "B"
resX = resx[resx$task==usetask,]
resX = resX[!is.na(resX$cost),]
# convert analytical to column
resX$analytical = NA
resX$analytical[as.numeric(resX$fun_nr)==3] = 99.0805650087345
resX$analytical[as.numeric(resX$fun_nr)==4] = 150
resX$analytical_power = NA
resX$analytical_power[as.numeric(resX$fun_nr)==3] = 0.786687772969949
resX$analytical_power[as.numeric(resX$fun_nr)==4] = 0.787123625772207
resX = resX[resX$learner!="Analytical",]
fn_nr = 2
resX1 = resX[resX$fun_nr=="2 ANOVA",]
atx = at[[fn_nr]]
true_power.fun = atx$true_power.fun
actual_power = atx$actual_power
actual_cost = atx$actual_cost
x1 = load.cond(fn_nr,usetask,budget=NA,goal.ci=NA)
costfun=x1$cost
design=x1$design
costfun
design
xvals = seq(min(resX1$X1,na.rm=T),max(resX1$X1,na.rm=T),.5)
eqpower.y = sapply(xvals,function(x) {
fn = function(y) abs(true_power.fun(c(x,y))-actual_power)
a = optim(20,fn,method="L-BFGS-B",lower=design[[2]][[1]],upper=design[[2]][[2]])
legit = a$value<.001
if(legit) return(a$par) else return(NA)
})
xvals
actual_power
actual_cost
xvals = seq(min(resX1$X1,na.rm=T),max(resX1$X1,na.rm=T),.5)
eqpower.y = sapply(xvals,function(x) {
fn = function(y) abs(true_power.fun(c(x,y))-actual_power)
a = optim(20,fn,method="L-BFGS-B",lower=design[[2]][[1]],upper=design[[2]][[2]])
legit = a$value<.001
if(legit) return(a$par) else return(NA)
})
eqpower = data.frame(X1=xvals,X2=eqpower.y)
eqcost.y = sapply(xvals,function(x) {
fn = function(y) abs(costfun(c(x,y))-actual_cost)
optim(20,fn,method="L-BFGS-B",lower=design[[2]][[1]],upper=design[[2]][[2]])$par})
eqcost = data.frame(X1=xvals,X2=eqcost.y)
# ignore some wrong values
correct = sapply(1:nrow(eqcost),function(i) {
costfun(eqcost[i,])==actual_cost
})
correct
eqcost
dat.at = data.frame(t(atx$actually_true))
devtools::load_all(".")
load.libs()
# Load Results ------------------------------------------------------------
restag = c("48","49","50","51")
folder = "C:/Users/admin/switchdrive/4 irt/paper 2/"
# folder = "C:/Users/admin/switchdrive/4 irt/paper 2/"
rest = list()
for (i in restag) {
load(file= paste0(folder,"res_",i,".Rdata"))
rest = c(rest,res)
}
res = rest
load(file= paste0(folder,"at.Rdata"))
usetask = "B"
resX = resx[resx$task==usetask,]
resX = resX[!is.na(resX$cost),]
# convert analytical to column
resX$analytical = NA
resX$analytical[as.numeric(resX$fun_nr)==3] = 99.0805650087345
resX$analytical[as.numeric(resX$fun_nr)==4] = 150
resX$analytical_power = NA
resX$analytical_power[as.numeric(resX$fun_nr)==3] = 0.786687772969949
resX$analytical_power[as.numeric(resX$fun_nr)==4] = 0.787123625772207
dat = data.frame(X1,X2)
dat = data.frame(X1=c(),X2=c())
dat
dat = data.frame(X1=c(1),X2=c(1))
dat
dat = data.frame(X1=c(1),X2=c(1))
for (i in 40:80) {
for (j in 5:16) {
dat[nrow(dat)+1,] = c(i,j)
}}
dat
p7 = ggplot() + theme_bw()  + xlim(40, 80) + ylim(5,16) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 16), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=5) +
annotate(geom="text", x=61, y=14, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=67, y=7, label="Optimal Cost", color="#B2182B",size = 5,hjust = "right") +
annotate(geom="text", x=58, y=10, label="Optimal Set", color="black",size = 5, hjust = "right") +
theme(legend.position="none") +
geom_point(data=dat, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=5)
g1 = grid.arrange(p7,p7, ncol=2)
pdf(paste0(folder,"multi_true_2D.pdf"),height=6,width=11);grid.draw(g1);dev.off()
costfun(c(57,11))
actual_cost
p7 = ggplot() + theme_bw()  + xlim(40, 80) + ylim(5,16) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 16), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=5) +
annotate(geom="text", x=61, y=14, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=67, y=7, label="Optimal Cost", color="#B2182B",size = 5,hjust = "right") +
annotate(geom="text", x=58, y=10, label="Optimal Set", color="black",size = 5, hjust = "right") +
theme(legend.position="none")
g1 = grid.arrange(p7,p7, ncol=2)
pdf(paste0(folder,"multi_true_2D.pdf"),height=6,width=11);grid.draw(g1);dev.off()
usetask = "B"
resX = resx[resx$task==usetask,]
resX = resX[!is.na(resX$cost),]
# convert analytical to column
resX$analytical = NA
resX$analytical[as.numeric(resX$fun_nr)==3] = 99.0805650087345
resX$analytical[as.numeric(resX$fun_nr)==4] = 150
resX$analytical_power = NA
resX$analytical_power[as.numeric(resX$fun_nr)==3] = 0.786687772969949
resX$analytical_power[as.numeric(resX$fun_nr)==4] = 0.787123625772207
resX = resX[resX$learner!="Analytical",]
fn_nr = 2
resX1 = resX[resX$fun_nr=="2 ANOVA",]
atx = at[[fn_nr]]
true_power.fun = atx$true_power.fun
actual_power = atx$actual_power
actual_cost = atx$actual_cost
x1 = load.cond(fn_nr,usetask,budget=NA,goal.ci=NA)
costfun=x1$cost
design=x1$design
xvals = seq(min(resX1$X1,na.rm=T),max(resX1$X1,na.rm=T),.5)
eqpower.y = sapply(xvals,function(x) {
fn = function(y) abs(true_power.fun(c(x,y))-actual_power)
a = optim(20,fn,method="L-BFGS-B",lower=design[[2]][[1]],upper=design[[2]][[2]])
legit = a$value<.001
if(legit) return(a$par) else return(NA)
})
eqpower = data.frame(X1=xvals,X2=eqpower.y)
eqcost.y = sapply(xvals,function(x) {
fn = function(y) abs(costfun(c(x,y))-actual_cost)
optim(20,fn,method="L-BFGS-B",lower=design[[2]][[1]],upper=design[[2]][[2]])$par})
eqcost = data.frame(X1=xvals,X2=eqcost.y)
# ignore some wrong values
correct = sapply(1:nrow(eqcost),function(i) {
costfun(eqcost[i,])==actual_cost
})
eqcost = eqcost[correct,]
dat.at = data.frame(t(atx$actually_true))
eqpower = eqpower[!is.na(eqpower$X2),]
# eqpower = eqpower[eqpower$X2<=20,]
# eqcost = eqcost[eqcost$X1>=40,]
p7 = ggplot() + theme_bw()  + xlim(40, 80) + ylim(5,16) +
scale_colour_manual(values = c("#B2182B", "#2166AC","black"), guide = guide_legend(title="",override.aes = list(linetype = c("solid", "solid","blank"),shape = c(NA, NA,3)))) +
xlab("Participants per Cluster") +
ylab("Number of Clusters") +
geom_ribbon(data=eqpower,aes(x=X1,ymin = X2, ymax = 16), fill = "#92C5DE") +
geom_line(data=eqpower,aes(x=X1, y=X2,col="Minimal power"),size=1)+
geom_line(data=eqcost,aes(x=X1, y=X2,col="Maximal cost"),size=1)+
geom_point(data=dat.at, aes(x=X1, y=X2,col="Optimal set"),shape=3,size=5) +
annotate(geom="text", x=61, y=14, label="Desired Power", color="#2166AC",size = 5) +
annotate(geom="text", x=67, y=7, label="Optimal Cost", color="#B2182B",size = 5,hjust = "right") +
annotate(geom="text", x=58, y=10, label="Optimal Set", color="black",size = 5, hjust = "right") +
theme(legend.position="none")
g1 = grid.arrange(p7,p7, ncol=2)
pdf(paste0(folder,"multi_true_2D.pdf"),height=6,width=11);grid.draw(g1);dev.off()
